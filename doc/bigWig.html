<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Luther Vucic" />

<meta name="date" content="2019-09-15" />

<title>bigWig</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">bigWig</h1>
<h4 class="author">Luther Vucic</h4>
<h4 class="date">09/15/2019</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>bigWig is a R package that has utility function for analyzing and manipulating bigWig files.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<div id="install-package" class="section level2">
<h2>Install package</h2>
<p>Since bigWig is not available on CRAN, we can not use the basic <code>install.packages(&#39;bigWig&#39;)</code>. However, there are several ways to install packages. Here I will explain 2 of them.</p>
<div id="from-github" class="section level3">
<h3>From Github</h3>
<p>The most up to date version of the <code>bigWig</code> pkg is located at <a href="https://github.com/andrelmartins/bigWig">bigWig</a>. Using <code>devtools</code>, you can download and install <code>bigWig</code> from github directly.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#install devtools if necessary</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#location of bigWig package and subfolder</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>pkgLoc=<span class="st">&#39;andrelmartins/bigWig&#39;</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>subFld=<span class="st">&#39;bigWig&#39;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(pkgLoc, <span class="dt">subdir=</span>subFld)</span></code></pre></div>
</div>
<div id="from-local-directory" class="section level3">
<h3>From local directory</h3>
<p>If you don’t have an internet connection or don’t use github, you can build from the sources file.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#install devtools if necessary</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#Set the working directory to the directory where the source files are located</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">setwd</span>(<span class="st">&#39;~/Dir&#39;</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">build</span>()</span></code></pre></div>
</div>
</div>
</div>
<div id="usage" class="section level1">
<h1>Usage</h1>
<p>After installation like any other package bigwig needs to be loaded with</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(bigWig)</span></code></pre></div>
<p>For these examples, we will use PRO-seq data from <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE126919">GSE126919_RAW</a>.</p>
<p>Download the tar ball and unpack it in a local directory of your choice. Then in R make sure that you define the directory and filename.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#directory where data is stored</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>dtDir=<span class="st">&#39;/home/directory&#39;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># specific bigWig file being used</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>dtFn=<span class="st">&#39;GSM3618124_HEK293T_TIR1_Cl4_3hrDMSO_rep1_minus_body_0-mer.bigWig&#39;</span></span></code></pre></div>
<div id="bigwig-utilities" class="section level2">
<h2>bigWig utilities</h2>
<p>These a functions that load, unload, query and print the information that is in each bigWig.</p>
<div id="load.bigwig" class="section level3">
<h3>load.bigWig</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">load.bigWig</span>(filename, <span class="dt">udcDir =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<ul>
<li><p>arguments</p>
<ul>
<li><p><code>filename</code> [required] is a string, which is either the the local file directory or URL.</p></li>
<li><p><code>udcDir</code> is a string which is the location for storing cached copies of remote files locally, while in use. Theseare destroyed when you unload the bigWig. If left as the default <code>udcDir = NULL</code>, then it uses <code>/tmp/udcCache</code>.</p></li>
</ul></li>
</ul>
<p><code>load.bigWig</code> creates a list in <code>R</code>. This list contains relevant informasyion about the bigWig file and serves as a pointer to the underlying C object of the entire bigWig file. The only parameter required for this is a string of the location and filename.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>bw=<span class="kw">load.bigWig</span>(<span class="kw">paste0</span>(dtDir, dtFn))</span></code></pre></div>
</div>
<div id="unload.bigwig" class="section level3">
<h3>unload.bigWig</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">unload.bigWig</span>(bw)</span></code></pre></div>
<ul>
<li>arguements
<ul>
<li><code>bw</code> is the <code>R</code> pointer created in <code>load.bigWig</code></li>
</ul></li>
</ul>
<p>Use <code>unload.bigWig(bw)</code> to destroy the C object and remove it from memory. This does not clear the <code>R</code> list. To do that use <code>rm()</code> or <code>remove()</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">unload.bigWig</span>(bw)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">ls</span>()</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt; [1] &quot;bw&quot;    &quot;dtDir&quot; &quot;dtFn&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">remove</span>(bw)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="kw">ls</span>()</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; [1] &quot;dtDir&quot; &quot;dtFn&quot;</span></span></code></pre></div>
</div>
<div id="query.bigwig" class="section level3">
<h3>query.bigWig</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">query.bigWig</span>(bw, chrom, start, end, <span class="dt">clip =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw</code> is the <code>R</code> pointer created in <code>load.bigWig</code></li>
<li><code>chrom</code> is a string referring to what chromosome is referenced</li>
<li><code>start</code> is an integer value designation the starting position</li>
<li><code>end</code> is an integer value designation the ending position</li>
<li><code>clip</code> is a logical value; if TRUE bigWig regions are clipped to the query interval.</li>
</ul></li>
</ul>
<p><code>query.bigWig</code> allows you to search the bigWig files for specific chromosomes (<code>chrom=&#39;chr1&#39;</code>, a string representative of the desired chromosome) within a defined window (<code>start=1, end = 12000</code> both are integers and end is inclusive meaning it searches up to and including <code>end</code>). It then prints query results to the command line.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">query.bigWig</span>(bw, <span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>, <span class="dt">start=</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">12000</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt;       start   end value</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt;  [1,] 10496 10497     1</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt;  [2,] 10500 10501     1</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt;  [3,] 10518 10519     1</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt;  [4,] 10521 10522     2</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt;  [5,] 10527 10528     1</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt;  [6,] 10535 10536     1</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;  [7,] 10541 10542     1</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt;  [8,] 10554 10555     1</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt;  [9,] 10933 10934     1</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; [10,] 11081 11082     2</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; [11,] 11165 11166     1</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; [12,] 11456 11457     1</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; [13,] 11584 11585     1</span></span></code></pre></div>
<p>You can set the query to a variable for storage</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>bwQ=<span class="kw">query.bigWig</span>(bw, <span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>, <span class="dt">start=</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">20000</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>bwQ[<span class="dv">3</span>]</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; [1] 10518</span></span></code></pre></div>
<p>Then access the array like any other indexed array. This returns the entire row.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>bwQ[<span class="dv">1</span>,]</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; start   end value </span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; 10496 10497     1</span></span></code></pre></div>
<p>This returns the specific row and column.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>bwQ[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt;   end </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; 10497</span></span></code></pre></div>
<p>It can be accesed by keyword too.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>bwQ[<span class="dv">1</span>,<span class="st">&#39;start&#39;</span>]</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#&gt; start </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; 10496</span></span></code></pre></div>
<p><code>clip</code> need to create instance</p>
</div>
<div id="print.bigwig" class="section level3">
<h3>print.bigWig</h3>
<p><code>print.bigWig(bw)</code> is used to print all of the attributes contained within the object.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">print.bigWig</span>(bw)</span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw</code> is the <code>R</code> pointer created in <code>load.bigWig</code></li>
</ul></li>
</ul>
<pre><code>#&gt; bigWig
#&gt;  version: 4
#&gt;  isCompressed TRUE
#&gt;  isSwapped FALSE
#&gt;  primaryDataSize: 11,243,315
#&gt;  primaryIndexSize: 176,800
#&gt;  zoomLevels: 7
#&gt;  chromCount: 455
#&gt;      chr1 248956422 
#&gt;      chr10 133797422 
#&gt;      chr10_GL383545v1_alt 179254 
#&gt;      chr10_GL383546v1_alt 309802 
#&gt;      chr10_KI270824v1_alt 181496
#&gt;      ...
#&gt;      chrX 156040895 
#&gt;      chrX_KI270880v1_alt 284869 
#&gt;      chrX_KI270881v1_alt 144206 
#&gt;      chrX_KI270913v1_alt 274009 
#&gt;      chrY 57227415 
#&gt;      chrY_KI270740v1_random 37240
#&gt;  basesCovered: 5,010,318
#&gt;  mean:  1.187913
#&gt;  min:  1
#&gt;  max:  3034
#&gt;  std:  5.843396</code></pre>
</div>
</div>
<div id="region" class="section level2">
<h2>Region</h2>
<p>The following sections group <code>bpQuery</code> and <code>probeQuery</code> functions together because they operate the same except on how they calculate the average.</p>
<div id="region.xxx.bigwig" class="section level3">
<h3>region.xxx.bigwig</h3>
<p>This set of functions takes a region defined by <code>chrom</code>, <code>start</code> and <code>end</code> and returns the result of the operation on the counts.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">region.bpQuery.bigWig</span>(bw, chrom, start, end,</span>
<span id="cb17-2"><a href="#cb17-2"></a>                       <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>                      <span class="dt">bwMap =</span> <span class="ot">NULL</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="kw">region.probeQuery.bigWig</span>(bw, chrom, start, end,</span>
<span id="cb17-5"><a href="#cb17-5"></a>                      <span class="dt">op =</span> <span class="st">&quot;wavg&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="ot">NA</span>)</span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw</code> is the <code>R</code> pointer created in <code>load.bigWig</code></li>
<li><code>chrom</code> is a string referring to what chromosome is referenced</li>
<li><code>start</code> is an integer value designation the starting position</li>
<li><code>end</code> is an integer value designation the ending position</li>
<li><code>op</code> is a string representing the operation to perform on the step.
<ul>
<li><code>sum</code> adds all the counts</li>
<li><code>avg</code> averages the counts</li>
<li><code>min</code> finds the smallest count</li>
<li><code>max</code> finds the largest count</li>
</ul></li>
<li><code>abs.value</code> is a logical argument which determines if the absolute value of the input is performed before the <code>op</code>.</li>
<li><code>bwMap</code> is a bigWig file of areas that cannot be mapped for a reason</li>
</ul></li>
</ul>
<p>This set of functions, <code>region.xxx.bigWig</code>, takes a region defined by <code>chrom</code>, <code>start</code> and <code>end</code> and returns the result of the operation on the counts. This allows you to find out basic information on a specific query. Starting with a specific query,</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">query.bigWig</span>(bw, <span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>, <span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#&gt;       start    end value</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; [1,] 229991 229992     1</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; [2,] 230002 230003     2</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt; [3,] 230077 230078     1</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt; [4,] 230082 230083     1</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt; [5,] 230113 230114     1</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">#&gt; [6,] 230132 230133     1</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; [7,] 230146 230147     2</span></span></code></pre></div>
<p>Operations To find how many instances there are where there is a ‘chr2’ in the bigWig</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">region.bpQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw">region.probeQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt; [1] 9</span></span></code></pre></div>
<p>If you want to find the highest number of instances of chr2</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">region.bpQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;max&#39;</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw">region.probeQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;max&#39;</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>To find the lowest number of instances</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">region.bpQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;min&#39;</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw">region.probeQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;min&#39;</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>To find the average</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">region.bpQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;avg&#39;</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#&gt; [1] 0.03673469</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="kw">region.probeQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr2&#39;</span>,<span class="dt">start=</span><span class="dv">229990</span>, <span class="dt">end=</span><span class="dv">230235</span>, <span class="dt">op=</span><span class="st">&#39;avg&#39;</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt; [1] 1.285714</span></span></code></pre></div>
<p><code>bpQuery</code> counts the number of base pairs to use as the denominator. This is the difference of the <code>end</code> value and the <code>start</code> value.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="dv">230235-229990</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt; [1] 245</span></span></code></pre></div>
<p><code>probeQuery</code> counts the number of probes. Essentially, this is the number of rows returned by the query. Here, it is 7.</p>
<p>Sometimes, the bigWig will have negative values. To keep these values in the counts the <code>abs.value=TRUE</code> option can be used. For this example, you’ll need a different data set. <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM3452725">negative bigWig files</a>. Download both</p>
<ul>
<li>GSM3452725_K562_Nuc_NoRNase_minus.bw</li>
<li>GSM3452725_K562_Nuc_NoRNase_plus.bw</li>
</ul>
<p>and store them in thier own directory. Then using the <code>load.bigWig</code> and store them as <code>bw.plus</code> and <code>bw.minus</code>, respectively. We will use them in later examples.</p>
<p>When we run a query on <code>bw.minus</code>, you can see that it returns negative counts. You can check out the appendix to see how to search and find negative values.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">query.bigWig</span>(bw.minus, <span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>, <span class="dt">start=</span><span class="dv">10140</span>, <span class="dt">end=</span><span class="dv">10190</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">#&gt;      start   end value</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">#&gt; [1,] 10151 10153    -1</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">#&gt; [2,] 10153 10154    -2</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co">#&gt; [3,] 10154 10155    -1</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">#&gt; [4,] 10158 10160    -1</span></span></code></pre></div>
<p>There is a reason the bigWig file returns negative values. We only care about the case that there is a recorded event [+/-]. In this case, we apply the <code>abs.value=TRUE</code> which takes the absolute value of each count before applying the operation. Remember the default is <code>abs.value=FALSE</code></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">region.probeQuery.bigWig</span>(bw.minus,<span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>,<span class="dt">start=</span><span class="dv">10140</span>, <span class="dt">end=</span><span class="dv">10190</span>, <span class="dt">op=</span><span class="st">&#39;avg&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#&gt; [1] -1.25</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw">region.probeQuery.bigWig</span>(bw.minus,<span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>,<span class="dt">start=</span><span class="dv">10140</span>, <span class="dt">end=</span><span class="dv">10190</span>, <span class="dt">op=</span><span class="st">&#39;avg&#39;</span>, <span class="dt">abs.value=</span><span class="ot">TRUE</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">#&gt; [1] 1.25</span></span></code></pre></div>
</div>
<div id="bed.region.xxx.bigwig" class="section level3">
<h3>bed.region.xxx.bigwig</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">bed.region.bpQuery.bigWig</span>(bw, bed,</span>
<span id="cb26-2"><a href="#cb26-2"></a>                          <span class="dt">strand =</span> <span class="ot">NA</span>, <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="dv">0</span>,</span>
<span id="cb26-3"><a href="#cb26-3"></a>                          <span class="dt">bwMap =</span> <span class="ot">NULL</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="kw">bed.region.probeQuery.bigWig</span>(bw, bed,</span>
<span id="cb26-5"><a href="#cb26-5"></a>                          <span class="dt">op =</span> <span class="st">&quot;wavg&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="ot">NA</span>)</span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw</code> is the <code>R</code> pointer created in <code>load.bigWig</code></li>
<li><code>bed</code> is a dataframe structured like a bed file with columns for <code>chrom</code>, <code>start</code> and <code>end</code></li>
<li><code>chrom</code> is a string referring to what chromosome is referenced</li>
<li><code>start</code> is an integer value designation the starting position</li>
<li><code>end</code> is an integer value designation the ending position</li>
<li><code>op</code> is a string representing the operation to perform on the step.
<ul>
<li><code>sum</code> adds all the counts</li>
<li><code>avg</code> averages the counts</li>
<li><code>min</code> finds the smallest count</li>
<li><code>max</code> finds the largest count</li>
</ul></li>
<li><code>abs.value</code> is a logical argument which determines if the absolute value of the input is performed before the <code>op</code>.</li>
</ul></li>
</ul>
<p>This function is similar to <code>region.bpQuery.bigWig</code> except that when defining the areas we want to examine is defined in a bed file rather than <code>chrom</code>, <code>start</code>, and <code>end</code>.</p>
<p>The source of the bed file can be something created by hand or previous identified regions from other experiments. The basics of the bed is that it’s in a R data frame.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>bed=<span class="kw">data.frame</span>(<span class="st">&#39;chr1&#39;</span>,<span class="dv">10496</span>,<span class="dv">10497</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co">#set column headers</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="kw">colnames</span>(bed)=<span class="kw">c</span>(<span class="st">&#39;chrom&#39;</span>,<span class="st">&#39;start&#39;</span>, <span class="st">&#39;end&#39;</span>)</span></code></pre></div>
<p>Now this is for a single factor in R. When creating a dataframe in R, it automatically turns strings into factors. This limits the ability to add different <code>chrom</code> designations. Meaning that when created the original bed file, <code>chr1</code> was the only level created. It will return an error if you just try to add</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">rbind</span>(bed, <span class="kw">c</span>(<span class="st">&#39;chr2&#39;</span>, <span class="dv">10000</span>, <span class="dv">20000</span>))</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, ri, value = &quot;chr2&quot;): invalid factor level,</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt; NA generated</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">#&gt;   chrom start   end</span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">#&gt; 1  chr1 10496 10497</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co">#&gt; 2  &lt;NA&gt; 10000 20000</span></span></code></pre></div>
<p>If you ever want to add different factors, you’ll need to use <code>levels()</code></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">levels</span>(bed<span class="op">$</span>chrom)=<span class="kw">c</span>(<span class="st">&#39;chr1&#39;</span>, <span class="st">&#39;chr2&#39;</span>)</span></code></pre></div>
<p>Take a look at how the data.frame is structured</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">dim</span>(bed)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">#&gt; [1] 1 3</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="kw">attributes</span>(bed)</span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co">#&gt; $names</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co">#&gt; [1] &quot;chrom&quot; &quot;start&quot; &quot;end&quot;  </span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co">#&gt; </span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">#&gt; $row.names</span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="co">#&gt; </span></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="co">#&gt; $class</span></span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>bed</span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="co">#&gt;   chrom start   end</span></span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="co">#&gt; 1  chr1 10496 10497</span></span></code></pre></div>
<p><code>dim</code> returns the size of the matrix [1 row, 3 columns]. while <code>attributes</code> returns information on column names, row names and class type.</p>
<p>You can take this bed file and run it through the bigWig file to see what parts overlap</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># note: If you leave out op=&#39;&#39;, it will default to op=&#39;sum&#39;</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw">bed.region.bpQuery.bigWig</span>(bw, bed)</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>Now adding a few other areas to the data frame</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>bed=<span class="kw">rbind</span>(bed, <span class="kw">c</span>(<span class="st">&#39;chr2&#39;</span>, <span class="dv">10500</span>,<span class="dv">10501</span>))</span></code></pre></div>
<p>In the original query, this region is occupied by a <code>chr1</code> and since the bed file refers to a <code>chr2</code> the sum should be the same because there is no overlap.Then if you rerun</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">bed.region.bpQuery.bigWig</span>(bw, bed)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co">#&gt; [1] 1 0</span></span></code></pre></div>
<p>We see that the then returned values are 1 and 0. This is because the first row of the bed file overlaps the bigWig, but the second row does not overlap.</p>
<p>Now adding a third row to the bed file that will overlap a larger range of the bigWig and rerun</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>bed2=<span class="kw">rbind</span>(bed, <span class="kw">c</span>(<span class="st">&#39;chr1&#39;</span>, <span class="dv">13000</span>,<span class="dv">14001</span>))</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="kw">bed.region.bpQuery.bigWig</span>(bw, bed2)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co">#&gt; [1]  1  0 11</span></span></code></pre></div>
<p>The returned values are the sums of the counts in those regions. ## step</p>
<p>The following functions operate over defined steps and is described by <code>step=</code> arguement. Same similarity applies between the <code>probeQuery</code> and <code>bpQuery</code> functions that they are the same instead of the calculation when <code>op=avg</code></p>
</div>
<div id="step.xxx.bigwig" class="section level3">
<h3>step.xxx.bigWig()</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">step.bpQuery.bigWig</span>(bw, chrom, start, end, step,</span>
<span id="cb35-2"><a href="#cb35-2"></a>                    <span class="dt">strand =</span> <span class="ot">NA</span>, <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="dv">0</span>,</span>
<span id="cb35-3"><a href="#cb35-3"></a>                    <span class="dt">bwMap =</span> <span class="ot">NULL</span>, <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="kw">step.probeQuery.bigWig</span>(bw, chrom, start, end, step,</span>
<span id="cb35-6"><a href="#cb35-6"></a>                    <span class="dt">op =</span> <span class="st">&quot;wavg&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="ot">NA</span>,</span>
<span id="cb35-7"><a href="#cb35-7"></a>                    <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw</code> is the <code>R</code> pointer created in <code>load.bigWig</code></li>
<li><code>chrom</code> is a string referring to what chromosome is referenced</li>
<li><code>start</code> is an integer value designation the starting position</li>
<li><code>end</code> is an integer value designation the ending position</li>
<li><code>op</code> is a string representing the operation to perform on the step.
<ul>
<li><code>sum</code> adds all the counts</li>
<li><code>avg</code> averages the counts</li>
<li><code>min</code> finds the smallest count</li>
<li><code>max</code> finds the largest count</li>
</ul></li>
<li><code>abs.value</code> is a logical argument which determines if the absolute value of the input is performed before the <code>op</code>.</li>
<li><code>gap.value</code> is an integer value that replaces areas that have no overlaps</li>
<li><code>with.attributes</code> is a logical argument that determines if the results are returned annotated with their source components and/or step size.</li>
</ul></li>
</ul>
<p>The Step function will run through the range provide breaking it up into equal size steps as defined by <code>step =</code>. The key here is that the length of the range [<code>end</code>-<code>start</code>] has to be a multiple of the step. For example if <code>end=21</code> and <code>start=1</code>, The length of the range is 20. This allows for <code>step = [1,2,4,5,10,20]</code>. The return is the value of the operation over that step. So if <code>step =1</code> and <code>op = &#39;min&#39;</code>, then the return would be 20 minimums.</p>
<p>Now if <code>step = 5</code> and <code>op = &#39;max&#39;</code>, the return will be a 4 element array of the maximum value in the step.</p>
<p>Let’s take a look over a 20000 interval <code>start=1</code>, <code>end=20001</code> and a <code>step=1000</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">step.bpQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>,<span class="dt">start=</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">20001</span>, <span class="dt">op=</span><span class="st">&#39;sum&#39;</span>, <span class="dt">step=</span><span class="dv">1000</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="co">#&gt;  [1]  0  0  0  0  0  0  0  0  0  0 10  5 11 11  1  1  2  0  4  3</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co">#&gt; attr(,&quot;chrom&quot;)</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co">#&gt; [1] &quot;chr1&quot;</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co">#&gt; attr(,&quot;start&quot;)</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co">#&gt; attr(,&quot;end&quot;)</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="co">#&gt; [1] 20001</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="co">#&gt; attr(,&quot;step&quot;)</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="co">#&gt; [1] 1000</span></span></code></pre></div>
<p>The result is a 20 element array of the sum of all the counts in the interval. Notice that the steps that have no counts are zero. If we needed to fill these values in with a specific number like 10, we use <code>gap.value=10</code></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">step.bpQuery.bigWig</span>(bw,<span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>,<span class="dt">start=</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">20001</span>, <span class="dt">op=</span><span class="st">&#39;sum&#39;</span>, <span class="dt">step=</span><span class="dv">10000</span>, <span class="dt">gap.value=</span><span class="dv">10</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co">#&gt; [1] 10 48</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co">#&gt; attr(,&quot;chrom&quot;)</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">#&gt; [1] &quot;chr1&quot;</span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="co">#&gt; attr(,&quot;start&quot;)</span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="co">#&gt; attr(,&quot;end&quot;)</span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="co">#&gt; [1] 20001</span></span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="co">#&gt; attr(,&quot;step&quot;)</span></span>
<span id="cb37-10"><a href="#cb37-10"></a><span class="co">#&gt; [1] 10000</span></span></code></pre></div>
</div>
<div id="bed.step.xxx.bigwig" class="section level3">
<h3>bed.step.xxx.bigWig()</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">bed.step.bpQuery.bigWig</span>(bw, chrom, start, end, step,</span>
<span id="cb38-2"><a href="#cb38-2"></a>                    <span class="dt">strand =</span> <span class="ot">NA</span>, <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="dv">0</span>,</span>
<span id="cb38-3"><a href="#cb38-3"></a>                    <span class="dt">bwMap =</span> <span class="ot">NULL</span>, <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="kw">bed.step.probeQuery.bigWig</span>(bw, bed, step,</span>
<span id="cb38-6"><a href="#cb38-6"></a>                    <span class="dt">op =</span> <span class="st">&quot;wavg&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="ot">NA</span>,</span>
<span id="cb38-7"><a href="#cb38-7"></a>                    <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>, <span class="dt">as.matrix =</span> <span class="ot">FALSE</span>)                    </span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw</code> is the <code>R</code> pointer created in <code>load.bigWig</code></li>
<li><code>bed</code> is a dataframe structured like a bed file with columns for <code>chrom</code>, <code>start</code> and <code>end</code></li>
<li><code>chrom</code> is a string referring to what chromosome is referenced</li>
<li><code>start</code> is an integer value designation the starting position</li>
<li><code>end</code> is an integer value designation the ending position</li>
<li><code>op</code> is a string representing the operation to perform on the step.
<ul>
<li><code>sum</code> adds all the counts</li>
<li><code>avg</code> averages the counts</li>
<li><code>min</code> finds the smallest count</li>
<li><code>max</code> finds the largest count</li>
</ul></li>
<li><code>abs.value</code> is a logical argument which determines if the absolute value of the input is performed before the <code>op</code>.</li>
<li><code>gap.value</code> is an integer value that replaces areas that have no overlaps</li>
<li><code>with.attributes</code> is a logical argument that determines if the results are returned annotated with their source components and/or step size.</li>
</ul></li>
</ul>
<p>This is similar to <code>bed.region.bigWig()</code>, where you can add a bed of regions that you are interested in.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co">#Create bed dataframe</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>bed3 =<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&#39;chr1&#39;</span>, <span class="dv">15000</span>, <span class="dv">25000</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="kw">colnames</span>(bed3)=<span class="kw">c</span>(<span class="st">&#39;chrom&#39;</span>, <span class="st">&#39;start&#39;</span>, <span class="st">&#39;end&#39;</span>)</span>
<span id="cb39-4"><a href="#cb39-4"></a>bed3=<span class="kw">rbind</span>(bed3, <span class="kw">c</span>(<span class="st">&quot;chr1&quot;</span>, <span class="dv">30000</span>, <span class="dv">35000</span>))</span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="kw">bed.step.bpQuery.bigWig</span>(bw, bed3, <span class="dt">step=</span><span class="dv">1000</span>, <span class="dt">op=</span><span class="st">&#39;avg&#39;</span>, <span class="dt">with.attributes=</span><span class="ot">FALSE</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="co">#&gt;  [1] 0.001 0.002 0.000 0.004 0.003 0.002 0.007 0.010 0.003 0.004</span></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="co">#&gt; </span></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="co">#&gt; [1] 0 0 0 0 0</span></span></code></pre></div>
<p>Notice that the defined regions in the bed file are exact multiples of the step. This is explained in the <code>bed.bpQuery.bigWig</code> example. The other attribute of this bed file is the regions defined do not need to be the same size. row 1 in the bed files contains 10 steps, while Row 2 has 5 steps. the final aspect of this example is that <code>bpQuery</code> version uses the <code>step</code> size as the denominator in the average. While <code>probeQuery</code> will use the number of rows in the query</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">bed.step.probeQuery.bigWig</span>(bw, bed3, <span class="dt">step=</span><span class="dv">1000</span>, <span class="dt">op=</span><span class="st">&#39;avg&#39;</span>, <span class="dt">with.attributes=</span><span class="ot">FALSE</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co">#&gt;  [1] 1.000000 1.000000       NA 1.000000 1.000000 1.000000 1.000000</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="co">#&gt;  [8] 1.111111 1.000000 1.000000</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co">#&gt; </span></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="co">#&gt; [1] NA NA NA NA NA</span></span></code></pre></div>
<p>In the <code>probe</code> version, we end up with <NA> where there are no overlapping regions. This is because dividing by zero is not possible. Instead the function returns a <NA>.</p>
</div>
<div id="bed6s" class="section level3">
<h3>bed6s</h3>
<p><code>bed.region.bpQuery.bigWig()</code> and <code>bed.step.bpQuery.bigWig()</code> have counterparts that can take a bed6 file. The bed6 file is similar to a bed file except it has 3 more columns of data.</p>
<p>Remember the standard bed file has <code>chrom</code>, <code>start</code> and <code>end</code>. The bed6 adds <code>name</code>, <code>score</code>, <code>strand</code> columns to its structure. For these functions, we only need the added <code>strand</code> column. However this column needs to be in the 6th position. Meaning even though <code>name</code> and <code>score</code> columns exist in the dataframe, they can be populated with nulls. You could populate it with identifying information, but the function essentially ignores them. The <code>strand</code> column requires either a <code>+</code> or <code>-</code> to denote the plus or minus strand.</p>
<p>Here is an example</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>bed6=<span class="kw">data.frame</span>(<span class="st">&#39;chr1&#39;</span>,<span class="dv">1</span>,<span class="dv">100000</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;+&#39;</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a>colnames=<span class="kw">c</span>(<span class="st">&#39;chrom&#39;</span>, <span class="st">&#39;start&#39;</span>, <span class="st">&#39;end&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;score&#39;</span>, <span class="st">&#39;strand&#39;</span>)</span></code></pre></div>
<p>This introduces the biological concept of plus and minus strands. This refers to the situation where the biological experiment returns the sense [plus strand] and it’s complimentary RNA strand, antisense [minus strand]</p>
<div id="bed6.region" class="section level4">
<h4>bed6.region</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">bed6.region.bpQuery.bigWig</span>(bw.plus, bw.minus, bed6,</span>
<span id="cb42-2"><a href="#cb42-2"></a>                           <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="dv">0</span>, <span class="dt">bwMap =</span> <span class="ot">NULL</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="kw">bed6.region.probeQuery.bigWig</span>(bw.plus, bw.minus, bed6, step,</span>
<span id="cb42-5"><a href="#cb42-5"></a>                          <span class="dt">op =</span> <span class="st">&quot;wavg&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="ot">NA</span>,</span>
<span id="cb42-6"><a href="#cb42-6"></a>                          <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>, <span class="dt">as.matrix =</span> <span class="ot">FALSE</span>,</span>
<span id="cb42-7"><a href="#cb42-7"></a>                          <span class="dt">follow.strand =</span> <span class="ot">FALSE</span>)                           </span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw.plus</code> is the <code>R</code> pointer created in <code>load.bigWig</code> and refers to the plus strand</li>
<li><code>bw.minus</code> is the <code>R</code> pointer created in <code>load.bigWig</code> and refers to the minus strand</li>
<li><code>chrom</code> is a string referring to what chromosome is referenced</li>
<li><code>start</code> is an integer value designation the starting position</li>
<li><code>end</code> is an integer value designation the ending position</li>
<li><code>op</code> is a string representing the operation to perform on the step.
<ul>
<li><code>sum</code> adds all the counts</li>
<li><code>avg</code> averages the counts</li>
<li><code>min</code> finds the smallest count</li>
<li><code>max</code> finds the largest count</li>
</ul></li>
<li><code>abs.value</code> is a logical argument which determines if the absolute value of the input is performed before the <code>op</code>.</li>
<li><code>gap.value</code> is an integer value that replaces areas that have no overlaps</li>
<li><code>with.attributes</code> is a logical argument that determines if the results are returned annotated with their source components and/or step size.</li>
</ul></li>
</ul>
<p>Let’s look at an example. We will use data from the negative values used with <code>abs.value = TRUE</code> In the Region section.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>dtDir =<span class="st"> &#39;/home/directory&#39;</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>dtFnPlus=<span class="st">&#39;GSM3452725_K562_Nuc_NoRNase_plus.bw&#39;</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>dtFnMinus=<span class="st">&#39;GSM3452725_K562_Nuc_NoRNase_minus.bw&#39;</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>bw.plus=<span class="kw">load.bigWig</span>(<span class="kw">paste0</span>(dtDirNeg, dtFnPlus))</span>
<span id="cb43-5"><a href="#cb43-5"></a>bw.minus=<span class="kw">load.bigWig</span>(<span class="kw">paste0</span>(dtDirNeg, dtFnMinus))</span></code></pre></div>
<p>Using the <code>bw.plus</code> and <code>bw.minus</code> strands, we can evaluate a <code>bed6.region</code> function. First, take a look at the query for each strand.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">query.bigWig</span>(bw.minus, <span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>, <span class="dt">start=</span><span class="dv">25000</span>, <span class="dt">end=</span><span class="dv">50000</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co">#&gt;      start   end value</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co">#&gt; [1,] 28567 28568    -1</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co">#&gt; [2,] 28570 28571    -1</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co">#&gt; [3,] 46605 46606    -1</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="co">#&gt; [4,] 47071 47072    -1</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co">#&gt; [5,] 49218 49219    -1</span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="kw">query.bigWig</span>(bw.plus, <span class="dt">chrom=</span><span class="st">&#39;chr1&#39;</span>, <span class="dt">start=</span><span class="dv">25000</span>, <span class="dt">end=</span><span class="dv">50000</span>)</span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co">#&gt;      start   end value</span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co">#&gt; [1,] 29459 29460     1</span></span></code></pre></div>
<p>These will beused as reference for when we use the function.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>bed6=<span class="kw">data.frame</span>(<span class="st">&#39;chr1&#39;</span>,<span class="dv">25000</span>,<span class="dv">50000</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;+&#39;</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">colnames</span>(bed6)=<span class="kw">c</span>(<span class="st">&#39;chrom&#39;</span>, <span class="st">&#39;start&#39;</span>, <span class="st">&#39;end&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;score&#39;</span>, <span class="st">&#39;strand&#39;</span>)</span></code></pre></div>
<p>This particular bed file defines a region between <code>start = 25000</code> and <code>end = 50000</code> on the <code>+</code> strand.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">bed6.region.probeQuery.bigWig</span>(bw.plus, bw.minus,</span>
<span id="cb46-2"><a href="#cb46-2"></a>                  bed6, <span class="dt">op=</span><span class="st">&#39;wavg&#39;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value=</span><span class="dv">0</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>The query of the plus strand shows only one overlapping region. The average of 1 region with 1 count is 1.</p>
<p>Now add another row to our <code>bed6</code> file and rerun the previous <code>bed6.region.probeQuery.bigWig</code> function.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">levels</span>(bed6<span class="op">$</span>strand)=<span class="kw">c</span>(<span class="st">&#39;+&#39;</span>, <span class="st">&#39;-&#39;</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a>bed6=<span class="kw">rbind</span>(bed6, <span class="kw">c</span>(<span class="st">&#39;chr1&#39;</span>, <span class="dv">25000</span>, <span class="dv">50000</span>, <span class="st">&#39;&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="st">&#39;-&#39;</span>))</span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="kw">bed6.region.probeQuery.bigWig</span>(bw.plus, bw.minus, bed6, <span class="dt">op=</span><span class="st">&#39;sum&#39;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value=</span><span class="dv">0</span>)</span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="co">#&gt; [1]  1 -5</span></span></code></pre></div>
<p>Similarly to the <code>bed.region</code> function the return is 2 values one for each overlapping region.</p>
<p>We can invoke <code>ab.value = TRUE</code> argument and our second result change to a positive value.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">bed6.region.probeQuery.bigWig</span>(bw.plus, bw.minus, bed6,</span>
<span id="cb48-2"><a href="#cb48-2"></a>                  <span class="dt">op=</span><span class="st">&#39;sum&#39;</span>, <span class="dt">abs.value =</span> <span class="ot">TRUE</span>, <span class="dt">gap.value=</span><span class="dv">0</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co">#&gt; [1] 1 5</span></span></code></pre></div>
</div>
<div id="bed6.step" class="section level4">
<h4>bed6.step</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw">bed6.step.bpQuery.bigWig</span>(bw.plus, bw.minus, bed6, step,</span>
<span id="cb49-3"><a href="#cb49-3"></a>                         <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="dv">0</span>,</span>
<span id="cb49-4"><a href="#cb49-4"></a>                         <span class="dt">bwMap =</span> <span class="ot">NULL</span>, <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>, <span class="dt">as.matrix =</span> <span class="ot">FALSE</span>,</span>
<span id="cb49-5"><a href="#cb49-5"></a>                         <span class="dt">follow.strand =</span> <span class="ot">FALSE</span>)</span>
<span id="cb49-6"><a href="#cb49-6"></a></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="kw">bed6.step.probeQuery.bigWig</span>(bw.plus, bw.minus, bed6, step,</span>
<span id="cb49-8"><a href="#cb49-8"></a>                          <span class="dt">op =</span> <span class="st">&quot;wavg&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="ot">NA</span>,</span>
<span id="cb49-9"><a href="#cb49-9"></a>                          <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>, <span class="dt">as.matrix =</span> <span class="ot">FALSE</span>,</span>
<span id="cb49-10"><a href="#cb49-10"></a>                          <span class="dt">follow.strand =</span> <span class="ot">FALSE</span>)      </span></code></pre></div>
<ul>
<li>arguments
<ul>
<li><code>bw.plus</code> is the <code>R</code> pointer created in <code>load.bigWig</code> and refers to the plus strand</li>
<li><code>bw.minus</code> is the <code>R</code> pointer created in <code>load.bigWig</code> and refers to the minus strand</li>
<li><code>chrom</code> is a string referring to what chromosome is referenced</li>
<li><code>start</code> is an integer value designation the starting position</li>
<li><code>end</code> is an integer value designation the ending position</li>
<li><code>op</code> is a string representing the operation to perform on the step.
<ul>
<li><code>sum</code> adds all the counts</li>
<li><code>avg</code> averages the counts</li>
<li><code>min</code> finds the smallest count</li>
<li><code>max</code> finds the largest count</li>
</ul></li>
<li><code>abs.value</code> is a logical argument which determines if the absolute value of the input is performed before the <code>op</code>.</li>
<li><code>gap.value</code> is an integer value that replaces areas that have no overlaps</li>
<li><code>with.attributes</code> is a logical argument that determines if the results are returned annotated with their source components and/or step size.</li>
</ul></li>
</ul>
<p>This is just like <code>step.bed.xxx</code> functions.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">bed6.step.bpQuery.bigWig</span>(bw.plus, bw.minus, bed6, <span class="dt">step=</span><span class="dv">5000</span>,</span>
<span id="cb50-2"><a href="#cb50-2"></a>                         <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="dv">0</span>,</span>
<span id="cb50-3"><a href="#cb50-3"></a>                         <span class="dt">bwMap =</span> <span class="ot">NULL</span>, <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>, <span class="dt">as.matrix =</span> <span class="ot">FALSE</span>,</span>
<span id="cb50-4"><a href="#cb50-4"></a>                         <span class="dt">follow.strand =</span> <span class="ot">FALSE</span>)</span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="co">#&gt; [1] 1 0 0 0 0</span></span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="co">#&gt; attr(,&quot;chrom&quot;)</span></span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="co">#&gt; [1] &quot;chr1&quot;</span></span>
<span id="cb50-9"><a href="#cb50-9"></a><span class="co">#&gt; attr(,&quot;start&quot;)</span></span>
<span id="cb50-10"><a href="#cb50-10"></a><span class="co">#&gt; [1] 25000</span></span>
<span id="cb50-11"><a href="#cb50-11"></a><span class="co">#&gt; attr(,&quot;end&quot;)</span></span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="co">#&gt; [1] 50000</span></span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="co">#&gt; attr(,&quot;step&quot;)</span></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co">#&gt; [1] 5000</span></span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="co">#&gt; </span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="co">#&gt; [1] -2  0  0  0 -3</span></span>
<span id="cb50-18"><a href="#cb50-18"></a><span class="co">#&gt; attr(,&quot;chrom&quot;)</span></span>
<span id="cb50-19"><a href="#cb50-19"></a><span class="co">#&gt; [1] &quot;chr1&quot;</span></span>
<span id="cb50-20"><a href="#cb50-20"></a><span class="co">#&gt; attr(,&quot;start&quot;)</span></span>
<span id="cb50-21"><a href="#cb50-21"></a><span class="co">#&gt; [1] 25000</span></span>
<span id="cb50-22"><a href="#cb50-22"></a><span class="co">#&gt; attr(,&quot;end&quot;)</span></span>
<span id="cb50-23"><a href="#cb50-23"></a><span class="co">#&gt; [1] 50000</span></span>
<span id="cb50-24"><a href="#cb50-24"></a><span class="co">#&gt; attr(,&quot;step&quot;)</span></span>
<span id="cb50-25"><a href="#cb50-25"></a><span class="co">#&gt; [1] 5000</span></span></code></pre></div>
<p>Here the attribute <code>as.matrix</code> will be introduced.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">bed6.step.bpQuery.bigWig</span>(bw.plus, bw.minus, bed6, <span class="dt">step=</span><span class="dv">5000</span>,</span>
<span id="cb51-2"><a href="#cb51-2"></a>                         <span class="dt">op =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">abs.value =</span> <span class="ot">FALSE</span>, <span class="dt">gap.value =</span> <span class="dv">0</span>,</span>
<span id="cb51-3"><a href="#cb51-3"></a>                         <span class="dt">bwMap =</span> <span class="ot">NULL</span>, <span class="dt">with.attributes =</span> <span class="ot">TRUE</span>, <span class="dt">as.matrix =</span> <span class="ot">TRUE</span>,</span>
<span id="cb51-4"><a href="#cb51-4"></a>                         <span class="dt">follow.strand =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Here is an example of <code>follow.strand</code></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co">#find length of chr1</span></span>
<span id="cb52-2"><a href="#cb52-2"></a></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="co">#query region start=len-50000 and end=len-25000</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
